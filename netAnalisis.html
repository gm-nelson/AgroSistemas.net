<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Network Monitor</title>

<style>
body{
  margin:0;
  background:#0f2027;
  color:#eaf6ff;
  font-family:system-ui;
  padding:20px;
}
.container{max-width:1200px;margin:auto}
h1{text-align:center}
.card{
  background:#16232e;
  padding:20px;
  border-radius:16px;
}
canvas{
  width:100%;
  background:#0e1a22;
  border-radius:12px;
  cursor:pointer;
}
.tooltip{
  position:absolute;
  background:#1c2f3d;
  border:1px solid #2a475a;
  padding:8px 10px;
  border-radius:8px;
  font-size:.8rem;
  pointer-events:none;
  display:none;
  color:#eaf6ff;
}
.legend{
  margin-top:8px;
  font-size:.85rem;
  display:flex;
  gap:15px;
}
.legend span{display:flex;gap:6px;align-items:center}
.dot{width:8px;height:8px;border-radius:50%}
</style>
</head>

<body>
<div class="container">
<h1>Network Monitor</h1>

<div class="card">
<canvas id="netChart" height="260"></canvas>

<div class="legend">
<span><div class="dot" style="background:#00c6ff"></div>Latency (ms)</span>
<span><div class="dot" style="background:#4caf50"></div>Download (Mbps)</span>
<span><div class="dot" style="background:#ffc107"></div>Upload (Mbps)</span>
</div>
</div>
</div>

<div class="tooltip" id="tooltip"></div>

<script>
/* ==========================
   DATA
========================== */
const canvas = document.getElementById('netChart');
const ctx = canvas.getContext('2d');
const tooltip = document.getElementById('tooltip');

let data = [];
const MAX = 20;

/* DEMO DATA */
setInterval(()=>{
  addSample({
    latency: Math.random()*180+30,
    down: Math.random()*60,
    up: Math.random()*25
  });
},2000);

function addSample(v){
  data.push({
    time:new Date().toLocaleTimeString(),
    latency:v.latency,
    down:v.down,
    up:v.up
  });
  if(data.length>MAX) data.shift();
  draw();
}

/* ==========================
   DRAW
========================== */
const pad = 45;
let points=[];

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  points=[];

  const w=canvas.width, h=canvas.height;
  const latMax=Math.max(...data.map(d=>d.latency),200);
  const downMax=Math.max(...data.map(d=>d.down),50);
  const upMax=Math.max(...data.map(d=>d.up),20);

  drawGrid(latMax);
  drawAxis(latMax);

  plot('latency',latMax,'#00c6ff','ms');
  plot('down',downMax,'#4caf50','Mbps');
  plot('up',upMax,'#ffc107','Mbps');
}

function drawGrid(maxY){
  ctx.strokeStyle='#1f3b4d';
  ctx.lineWidth=1;
  const steps=5;
  for(let i=0;i<=steps;i++){
    const y = pad + i*(canvas.height-pad-20)/steps;
    ctx.beginPath();
    ctx.moveTo(pad,y);
    ctx.lineTo(canvas.width-10,y);
    ctx.stroke();
  }
}

function drawAxis(maxY){
  ctx.strokeStyle='#4a6b82';
  ctx.beginPath();
  ctx.moveTo(pad,10);
  ctx.lineTo(pad,canvas.height-pad);
  ctx.lineTo(canvas.width-10,canvas.height-pad);
  ctx.stroke();

  ctx.fillStyle='#7fbcd9';
  ctx.font='10px system-ui';
  const steps=5;
  for(let i=0;i<=steps;i++){
    const val=Math.round(maxY - (maxY/steps)*i);
    const y=pad + i*(canvas.height-pad-20)/steps;
    ctx.fillText(val,y>canvas.height-pad-5?0:5,y+3);
  }
}

function plot(key,max,color,unit){
  const stepX=(canvas.width-pad-10)/(data.length-1);
  ctx.strokeStyle=color;
  ctx.beginPath();

  data.forEach((d,i)=>{
    const x=pad+i*stepX;
    const y=(canvas.height-pad)-(d[key]/max)*(canvas.height-pad-20);
    i?ctx.lineTo(x,y):ctx.moveTo(x,y);

    points.push({
      x,y,
      label:key,
      value:d[key].toFixed(1),
      unit,
      time:d.time,
      color
    });
  });
  ctx.stroke();

  // draw points
  points.filter(p=>p.label===key).forEach(p=>{
    ctx.fillStyle=color;
    ctx.beginPath();
    ctx.arc(p.x,p.y,4,0,Math.PI*2);
    ctx.fill();
  });
}

/* ==========================
   INTERACTION
========================== */
canvas.addEventListener('mousemove',e=>{
  const r=canvas.getBoundingClientRect();
  const mx=e.clientX-r.left;
  const my=e.clientY-r.top;

  const hit=points.find(p=>Math.hypot(p.x-mx,p.y-my)<6);
  if(hit){
    tooltip.style.display='block';
    tooltip.style.left=e.clientX+10+'px';
    tooltip.style.top=e.clientY+10+'px';
    tooltip.innerHTML=`
      <strong>${hit.label.toUpperCase()}</strong><br>
      ${hit.value} ${hit.unit}<br>
      ${hit.time}
    `;
  }else tooltip.style.display='none';
});

canvas.addEventListener('click',()=>{
  tooltip.style.borderColor='#00c6ff';
  setTimeout(()=>tooltip.style.borderColor='#2a475a',200);
});
</script>
</body>
</html>
