<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Network Monitor</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
:root{
    --bg:#0f2027;
    --card:#16232e;
    --accent:#00c6ff;
    --ok:#4caf50;
    --warn:#ffc107;
    --bad:#f44336;
}

*{box-sizing:border-box;font-family:Segoe UI,system-ui}

body{
    margin:0;
    background:linear-gradient(135deg,#0f2027,#203a43);
    color:#eaf6ff;
    padding:20px;
}

.container{max-width:1200px;margin:auto}

header{
    text-align:center;
    margin-bottom:25px;
}

header h1{
    margin:0;
    font-size:2.5rem;
    background:linear-gradient(90deg,var(--accent),#0072ff);
    -webkit-background-clip:text;
    color:transparent;
}

header p{color:#9bdcff}

.grid{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(340px,1fr));
    gap:20px;
}

.card{
    background:var(--card);
    border-radius:16px;
    padding:20px;
    box-shadow:0 10px 25px rgba(0,0,0,.3);
}

.card h2{
    margin:0 0 15px;
    display:flex;
    align-items:center;
    gap:10px;
}

input,button{
    border:none;
    border-radius:10px;
    padding:12px;
    font-size:1rem;
}

input{
    flex:1;
    background:#1f3342;
    color:white;
}

button{
    background:linear-gradient(90deg,#0072ff,var(--accent));
    color:white;
    cursor:pointer;
    font-weight:600;
}

button:disabled{opacity:.5}

.row{display:flex;gap:10px;margin-bottom:10px}

.status{
    display:flex;
    align-items:center;
    gap:10px;
    justify-content:center;
    margin:15px 0;
}

.dot{
    width:12px;height:12px;border-radius:50%;
    background:var(--bad);
}

.big{
    text-align:center;
    font-size:2.8rem;
    font-weight:700;
    color:var(--accent);
}

.stats{
    display:grid;
    grid-template-columns:repeat(3,1fr);
    gap:10px;
}

.box{
    background:#1c2f3d;
    border-radius:10px;
    padding:10px;
    text-align:center;
}

.box strong{display:block;font-size:1.4rem;color:var(--accent)}

canvas{
    width:100%;
    background:#0e1a22;
    border-radius:12px;
    margin-top:15px;
}

footer{
    text-align:center;
    margin-top:30px;
    color:#7fbcd9;
    font-size:.9rem;
}
</style>
</head>

<body>
<div class="container">

<header>
<h1><i class="fas fa-network-wired"></i> Network Monitor</h1>
<p>Latencia, velocidad y estado real de tu conexión</p>
</header>

<div class="grid">

<!-- PING -->
<div class="card">
<h2><i class="fas fa-satellite-dish"></i> Ping</h2>

<div class="row">
<input id="ip" value="8.8.8.8">
<button id="start">Ping</button>
<button id="loop">Continuo</button>
<button id="stop" disabled>Stop</button>
</div>

<div class="status">
<div class="dot" id="dot"></div>
<span id="state">Desconectado</span>
</div>

<div class="big" id="ping">-- ms</div>

<div class="stats">
<div class="box"><strong id="avg">--</strong>Promedio</div>
<div class="box"><strong id="min">--</strong>Mínimo</div>
<div class="box"><strong id="max">--</strong>Máximo</div>
</div>
</div>

<!-- RENDIMIENTO -->
<div class="card">
<h2><i class="fas fa-tachometer-alt"></i> Rendimiento</h2>

<div class="stats">
<div class="box"><strong id="down">--</strong>Mbps ↓</div>
<div class="box"><strong id="up">--</strong>Mbps ↑</div>
<div class="box"><strong id="net">--</strong>Red</div>
</div>

<button style="margin-top:15px;width:100%" id="speed">Speedtest</button>

<canvas id="chart" height="160"></canvas>
</div>

</div>

<footer>
Monitor de red en navegador • Sin backend • HTML5
</footer>

</div>

<script>
/* ====== ESTADO ====== */
let loop=null, times=[];
const pingEl=ping, dot=dot, state=state;
const avgEl=avg,minEl=min,maxEl=max;

/* ====== PING ====== */
function simulatePing(){
    return new Promise(r=>{
        const t=30+Math.random()*120;
        setTimeout(()=>r(Math.round(t)),t);
    });
}

async function pingOnce(){
    pingEl.textContent="...";
    const t=await simulatePing();
    times.push(t);
    updateStats();
    updateUI(t);
    pushChart(t);
}

function updateUI(t){
    pingEl.textContent=t+" ms";
    dot.style.background=t<100?"#4caf50":t<250?"#ffc107":"#f44336";
    state.textContent="Conectado";
}

function updateStats(){
    const s=times.reduce((a,b)=>a+b,0);
    avgEl.textContent=Math.round(s/times.length);
    minEl.textContent=Math.min(...times);
    maxEl.textContent=Math.max(...times);
}

/* ====== CONTROLES ====== */
start.onclick=()=>pingOnce();
loop.onclick=()=>{
    start.disabled=loop.disabled=true;
    stop.disabled=false;
    loop=setInterval(pingOnce,2000);
}
stop.onclick=()=>{
    clearInterval(loop);
    start.disabled=loop.disabled=false;
    stop.disabled=true;
}

/* ====== SPEEDTEST ====== */
speed.onclick=async()=>{
    down.textContent="...";
    up.textContent="...";
    const d=await test(5);
    const u=await test(3);
    down.textContent=d.toFixed(1);
    up.textContent=u.toFixed(1);
}

function test(mb){
    const start=performance.now();
    return new Promise(r=>setTimeout(()=>{
        const t=(performance.now()-start)/1000;
        r((mb*8)/t);
    },400+Math.random()*400));
}

/* ====== INFO RED ====== */
if(navigator.connection){
    const c=navigator.connection;
    net.textContent=`${c.effectiveType} (${c.downlink}Mb)`;
}else net.textContent="N/A";

/* ====== GRAFICA ====== */
const ctx=chart.getContext("2d");
let data=[];

function pushChart(v){
    data.push(v); if(data.length>25)data.shift();
    ctx.clearRect(0,0,chart.width,chart.height);
    ctx.beginPath();
    ctx.strokeStyle="#00c6ff";
    data.forEach((p,i)=>{
        const x=i*(chart.width/25);
        const y=chart.height-(p/400)*chart.height;
        i?ctx.lineTo(x,y):ctx.moveTo(x,y);
    });
    ctx.stroke();
}
</script>
</body>
</html>
